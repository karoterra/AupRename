# AupRename

AviUtl 拡張編集で使った動画・画像・音声等のファイルのパスを変更するツールです。

## インストール

[Releases](https://github.com/karoterra/AupRename/releases)
から最新版の ZIP ファイルをダウンロードし、好きな場所に展開してください。

- `AupRename-<バージョン>-win-x64-fd.zip`
    - .NET 8 ランタイムをインストール済みの場合
- `AupRename-<バージョン>-win-x64-sc.zip`
    - .NET 8 ランタイムをインストールせずに使う場合
    - よく分からないがとにかく使いたい場合

アンインストール時には展開したフォルダを削除してください。

### .NET 8 ランタイム

.NET 8 ランタイムがインストールされているか確認するにはコマンドプロンプトを起動して以下のコマンドを実行してください。

```cmd
dotnet --list-runtimes
```

実行後、画面に `Microsoft.WindowsDesktop.App` と表示されている行の中に `8.0.0` 以降の数字があれば .NET 8 ランタイムがインストールされています。
例えば `Microsoft.WindowsDesktop.App 8.0.12` と表示されていれば問題ありません。

.NET 8 ランタイムをインストールする場合には以下のページからデスクトップアプリ用のインストーラーをダウンロードしてインストールしてください。

[.NET 8.0 ランタイムのダウンロード](https://dotnet.microsoft.com/ja-jp/download/dotnet/8.0/runtime)

## 使い方

1. `AupRename.exe` を起動してください。
1. ファイルのパスを編集したい aup ファイルをウィンドウにドラッグアンドドロップしてください。
   念のため aup ファイルのバックアップを取っておくことをおすすめします。
2. パスの編集にはテキストエディタを使用するので、「編集するアプリケーション」にお好みのテキストエディタを指定してください。
3. 「フィルタ」から編集したいファイルの種類を選択してください。
    - 「図形」「マスク」「ディスプレイスメントマップ」「部分フィルタ」は、パスの先頭にアスタリスク `*` が付いていることがありますがこれは正常です。編集時には消さずに残しておいてください。
    - 「スクリプト」はアニメーション効果・カスタムオブジェクト・カメラ効果・シーンチェンジスクリプトで参照しているファイル (`file` 変数に代入されているファイル) を編集します。
4. 「新規編集」をクリックするとテキストエディタが開きます。各行にファイルのパスが書いてあるのでこれを編集して保存してください。
   この時行の入れ替えは行わないでください。テキストエディタを閉じてしまった場合は「再編集」をクリックすると再度開くことができます。
5. 「適用」をクリックするとテキストエディタで行った編集をもとに aup ファイルの中で指定されているファイルのパスを変更します。
   この時、変更したパスが正しいかどうかの確認は行いません。
6. 「元に戻す」をクリックすると aup ファイルを「新規編集」をクリックしたときの状態に戻します。

## 更新履歴

更新履歴は [CHANGELOG](CHANGELOG.md) を参照してください。

## ライセンス

このソフトウェアは MIT ライセンスのもとで公開されます。
詳細は [LICENSE](LICENSE) を参照してください。

使用したライブラリ等については [CREDITS](CREDITS.md) を参照してください。
